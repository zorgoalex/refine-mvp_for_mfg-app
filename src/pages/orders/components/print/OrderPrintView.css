/**
 * Стили для печати карточки заказа
 * Визуально максимально похоже на Excel шаблон
 */

/* Скрыть на экране, показать только при печати */
.order-print-view {
  display: none;
}

/* Стили для печати */
@media print {
  /* Настройки страницы */
  @page {
    size: A4 portrait;
    margin: 5mm 8mm;
  }

  /* Основной контейнер */
  .order-print-view {
    display: block;
    width: 100%;
    font-family: Arial, sans-serif;
    font-size: 8pt;
    color: #000;
    background: white;
    print-color-adjust: exact;
    -webkit-print-color-adjust: exact;
    position: relative;
  }

  /* Сброс стилей страницы */
  body {
    print-color-adjust: exact;
    -webkit-print-color-adjust: exact;
  }

  /* Убрать все остальные элементы при печати */
  body > *:not(.order-print-view) {
    display: none !important;
  }

  /* Шапка */
  .print-header,
  .additional-fields,
  .order-info {
    margin-bottom: 2px;
  }

  .print-row {
    display: table;
    width: 100%;
    border-collapse: collapse;
  }

  .print-row .cell {
    display: table-cell;
    border: 1px solid #000;
    padding: 1px 3px;
    font-size: 8pt;
    vertical-align: middle;
    min-height: 12px;
    line-height: 1.1;
  }

  /* Убираем ВСЕ вертикальные границы из ВСЕХ секций шапки */
  .print-header .print-row .cell,
  .additional-fields .print-row .cell,
  .order-info .print-row .cell {
    border-left: none !important;
    border-right: none !important;
  }

  /* Первая строка шапки - БЕЗ границ */
  .print-header .header-row-1 .cell {
    border-top: none;
    border-bottom: none;
  }

  /* Вторая строка шапки - только нижняя граница */
  .print-header .header-row-2 .cell {
    border-top: none;
    border-bottom: 1px solid #000;
  }

  /* Дополнительные поля - только горизонтальные границы */
  .additional-fields .print-row .cell {
    border-top: none;
    border-bottom: 1px solid #000;
  }

  /* Информация о заказе - только горизонтальные границы */
  .order-info .print-row .cell {
    border-top: none;
    border-bottom: 1px solid #000;
  }

  /* Специальные ячейки шапки */
  .cell-year {
    font-weight: bold;
    font-size: 11pt;
    text-align: center;
    width: 4%;
  }

  .cell-empty-narrow {
    width: 2%;
  }

  .cell-order-id {
    font-weight: bold;
    font-size: 11pt;
    text-align: center;
    width: 6%;
  }

  .cell-attachment {
    font-size: 1.5pt;
    width: 8%;
    text-align: center;
    line-height: 1.0;
  }

  .cell-attachment.red-text {
    color: #ff0000;
  }

  .cell-customer-label {
    font-size: 8pt;
    text-align: center;
    width: 50%;
  }

  .cell-total-label {
    font-size: 8pt;
    text-align: center;
    width: 30%;
  }

  .cell-customer-name {
    font-weight: bold;
    font-size: 9pt;
    text-align: center;
    width: 50%;
  }

  .cell-total-sum {
    font-weight: bold;
    font-size: 10pt;
    text-align: center;
    width: 30%;
  }

  /* Дополнительные поля */
  .additional-fields .cell {
    font-size: 7pt;
  }

  .additional-fields .cell.label {
    font-weight: normal;
    width: 8%;
  }

  .additional-fields .cell.value {
    font-weight: bold;
    width: 10%;
  }

  /* Информация о заказе */
  .order-info .cell.date-label {
    font-style: italic;
    font-size: 7pt;
    width: 5%;
    text-align: left;
  }

  .order-info .cell.date-value {
    font-weight: bold;
    font-size: 7pt;
    width: 10%;
    text-align: left;
  }

  .order-info .cell.notes-value {
    font-size: 7pt;
    width: 30%;
    text-align: left;
    padding-left: 10px;
  }

  .order-info .cell.spacer {
    width: 25%;
  }

  .order-info .cell.area-label {
    font-style: italic;
    font-size: 7pt;
    width: 12%;
    text-align: right;
    padding-right: 5px;
  }

  .order-info .cell.area-value {
    font-weight: bold;
    font-size: 7pt;
    width: 6%;
    text-align: right;
  }

  .order-info .cell.parts-label {
    font-size: 7pt;
    width: 8%;
    text-align: center;
    line-height: 1.0;
  }

  .order-info .cell.parts-value {
    font-weight: bold;
    font-size: 7pt;
    width: 4%;
    text-align: center;
  }

  /* Таблица деталей */
  .details-table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 2px;
    font-size: 7pt;
  }

  .details-table th,
  .details-table td {
    border: 1px solid #000;
    padding: 1px 2px;
    text-align: center;
    vertical-align: middle;
    line-height: 1.1;
  }

  .details-table th {
    font-weight: bold;
    background-color: #f0f0f0;
    font-size: 7pt;
    padding: 2px 2px;
  }

  /* Желтый фон для колонок Примечание и Пленка */
  .details-table th.highlight {
    background-color: #FFFF00 !important;
  }

  /* Вертикальный текст для колонок Кол-во и Облат */
  .details-table th.vertical-text {
    writing-mode: vertical-rl;
    text-orientation: mixed;
    padding: 4px 2px;
  }

  /* Ширины колонок */
  .col-num {
    width: 3%;
  }

  .col-height,
  .col-width {
    width: 6%;
  }

  .col-qty {
    width: 4%;
  }

  .col-area {
    width: 5%;
    text-align: right;
  }

  .col-type {
    width: 10%;
  }

  .col-edge {
    width: 5%;
  }

  .col-note {
    width: 15%;
    text-align: left;
  }

  .col-price {
    width: 8%;
    text-align: right;
  }

  .col-sum {
    width: 8%;
    text-align: right;
  }

  .col-film {
    width: 20%;
    text-align: left;
  }

  /* Пустые строки */
  .empty-row {
    height: 11px;
  }

  .empty-row td {
    font-size: 7pt;
    color: #666;
    padding: 0px 2px;
  }

  /* Футер */
  .print-footer {
    margin-top: 8px;
    font-size: 6pt;
    line-height: 1.2;
    page-break-inside: avoid;
  }

  .print-footer p {
    margin: 1px 0;
    padding: 0;
  }

  .print-footer .note-1 {
    font-weight: bold;
  }

  .print-footer .note-2 {
    font-style: italic;
  }

  .print-footer .note-3 {
    font-size: 6pt;
  }

  /* Предотвращение разрыва страницы */
  .print-header,
  .additional-fields,
  .order-info {
    page-break-inside: avoid;
  }

  .details-table {
    page-break-inside: auto;
  }

  .details-table tr {
    page-break-inside: avoid;
    page-break-after: auto;
  }

  .details-table thead {
    display: table-header-group;
  }

  /* Футер на последней странице */
  .print-footer {
    page-break-before: avoid;
  }

  /* Убрать margin/padding у body при печати */
  body {
    margin: 0;
    padding: 0;
  }
}
